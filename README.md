# Genomnom-DSA4262

This repository is designed for genomic data processing, model training, and evaluation as part of the DSA4262 project. It offers scripts for data preparation, feature selection, model training, predictions, and result visualization.

## Table of Contents

- Project Structure
- Setup and Installation
- Usage
- Pipeline Overview
- Scripts and Utilities
- Data Files
- Model Files
- Results and Visualizations

### Key Files and Folders

- **data/**: Holds training data, labeled data, and prediction outputs.
- **graphs/**: Stores visual results, such as PR and ROC curves, and feature importances.
- **model/**: Contains trained model files, hyperparameters, and logs.
- **scripts/**: Includes individual Python scripts for different stages of the pipeline.
- **utils/**: Helper scripts for dataset handling and other utilities.
- **main.py**: Main entry point for running the entire pipeline.

## Setup and Installation

1. **Clone the repository**:

   ```bash
   git clone https://github.com/M3rkr/genomnom-DSA4262.git
   cd genomnom-DSA4262
   ```
2. **Install dependencies**:

   ```bash
   pip install -r requirements.txt
   ```

## Usage

### Data Preprocessing

To preprocess the data, use:

```bash
python scripts/data_preprocessing.py
```

Inputs:

data/training/dataset0.json: Raw training data in JSON format.
data/training/data.info.labelled: Label information for training data.

Outputs:

model/aggregated_data.csv: Aggregated and encoded data ready for feature selection and training.

### Model Training

To train the model and optimize hyperparameters:

```bash
python scripts/model_training.py
```

**Inputs**:

- `model/aggregated_data_selected.csv`: Data selected for training after feature selection.

**Outputs**:

- `model/best_aggregated_model.pth`: Trained model with the best parameters.
- `model/best_hyperparams.json`: Hyperparameters of the best model.
- `model/training_log.json`: Training progress log.

### Inference

To run inference on new data:

```bash
python scripts/inference.py --input_file data/prediction/datasetX.json --output_file data/prediction/datasetX_prediction.csv
```

**Inputs**:

- `data/prediction/datasetX.json`: New data for predictions.

**Outputs**:

- `data/prediction/datasetX_prediction.csv`: Prediction scores.

### Evaluation

To evaluate model performance:

```bash
python scripts/evaluation.py
```

**Outputs**:

- `graphs/roc_curve.png`: ROC curve.
- `graphs/pr_curve.png`: Precision-Recall curve.
- Console output of performance metrics.

### Visualization

To plot training progress:

```bash
python scripts/visualization.py
```

**Outputs**:

- `graphs/training_progress.png`: Graph of training progress for ROC-AUC and PR-AUC over epochs.

### Full Pipeline

To run the entire pipeline, execute:

```bash
python main.py
```

## Pipeline Overview

The pipeline includes:

1. **Data Preprocessing**: Cleans and encodes the dataset for feature selection.
2. **Feature Selection**: Selects key features based on model relevance.
3. **Model Training**: Trains the model using optimal hyperparameters.
4. **Evaluation**: Assesses model performance and generates metrics.
5. **Inference**: Generates predictions on new datasets.
6. **Visualization**: Plots the training progress and other results.

## Scripts and Utilities

### Data Processing and Model Scripts

Each script is located in the `scripts/` folder and performs a unique function:

- `data_preprocessing.py`: Prepares raw data for feature selection and training.
- `model_training.py`: Trains and tunes the model.
- `inference.py`: Handles new data predictions.
- `evaluation.py`: Provides performance metrics.
- `visualization.py`: Generates graphs for training progress.

### Utilities

Located in `utils/`, these support data handling and model functions.

## Data Files

- `data/training/dataset0.json`: Raw training data.
- `data/training/data.info.labelled`: Label file for training data.
- `data/prediction/`: Holds predictions generated by the model.

## Model Files

- `model/best_aggregated_model.pth`: Best-trained model.
- `model/best_hyperparams.json`: Best model hyperparameters.
- `model/training_log.json`: Training log for plotting.

## Results and Visualizations

The `graphs/` folder contains:

- **feature_importances.png**: Feature importance scores.
- **roc_curve.png** and **pr_curve.png**: Performance graphs.
- **training_progress.png**: Graph of ROC-AUC and PR-AUC over epochs.
